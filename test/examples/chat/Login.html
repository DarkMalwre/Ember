<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <title>Login</title>
    <script src="/wjs"></script>
    <script>
        $(document).ready(() => {
            $("form").submit((e) => {
                e.preventDefault()

                send({
                    channel: "user:login",
                    message: {
                        user: $(".user").val(),
                        password: $(".password").val()
                    }
                })

                onMsg((msg) => {
                    if (msg.reply && msg.channel === "user:login") {
                        if (msg.message.error) {
                            $(".error").html(msg.message.error)
                        } else {
                            setCookie("token", msg.message.token)
                            setCookie("port", $(".port").val())
                            alert("You're logged in!")
                            location.href = "/"
                        }
                    }
                })
            })
        })
    </script>
</head>
<body>
    <div class="error">Please Login</div>

    <form>
        <input placeholder="User" class="user" /> <br />
        <input placeholder="Password" class="password" /> <br />
        <input placeholder="[ EXPERIMENTAL ] Custom Server Port" value="1000" class="port" />

        <button>Login</button>
    </form>
</body>
</html>